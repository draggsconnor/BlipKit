---
layout: doc
title: Context
full_title: BKContext object
order: 5
---

`BKContext` is the base object and contains the channel sound buffers. Sound is generated by [tracks](../track/) which are attached to the context. The context is also responsible for running the [timers](../clocks/) which update the effects and invoke the beat callback functions.

{% highlight c %}
// Context objects are defined statically
// You have to ensure that the variable is around as long as the context is used
BKContext ctx;

// Initialize context object
BKContextInit (& ctx, 2, 44100);

// Work with the context
...

// Dispose context object when not used anymore
// Track which are still attached are detached now and resources are freed
BKContextDispose (& ctx);
{% endhighlight %}

This initializes a `BKContent` object with 2 channels (stereo) and a sample rate of 44100 Hz. The maximum number of channels is `BK_MAX_CHANNELS` (8). The sample rate can range between `BK_MIN_SAMPLE_RATE` (16000) and `BK_MAX_SAMPLE_RATE` (96000). Lower or highter values are clamped.

## Attributes

The context

Attributes control the behaviour of a context object. The following list contains integer attributes which can be changed with with the function `BKContextSetAttr` or retrieved with the function `BKContextGetAttr`. Some attributes use a more complex data type and can be set with `BKContextSetPtr` or be retrieved with `BKContextGetPtr`

<dl>
<dt><var>BK_SAMPLE_RATE</var> (<var>BKInt</var>) (read-only)</dt>
<dd>

<p>The sample rate on which basis the note frequencies are calculated. This attribute is read-only and can only be set at initialization.</p>

{% highlight c %}
BKInt sampleRate;

// Read sample rate
BKContextGetAttr (& ctx, BK_SAMPLE_RATE, & sampleRate);

// sampleRate has the value 44100
{% endhighlight %}

</dd>
<dt><var>BK_NUM_CHANNELS</var> (<var>BKInt</var>) (read-only)</dt>
<dd>

<p>Number of channels in which the sound data is rendered. Attributes and track effects which affect panning have only an effect when this number is exactly 2 (stereo). This attribute is read-only and can only be set at initialization.</p>

{% highlight c %}
BKInt numChannels;

// Read number of channels
BKContextGetAttr (& ctx, BK_NUM_CHANNELS, & numChannels);

// numChannels has the value 2
{% endhighlight %}

</dd>

<dt><var>BK_CLOCK_PERIOD</var> (<var>BKTime</var>)</dt>
<dd>

<p>The master clocks's time period. This is a <a href="../clocks/">BKTime</a> struct. The default value is 1/240 seconds (240 Hz). Use this attribute if a finer time granularity is required.</p>

{% highlight c %}
// Make time value
BKTime time = BKTimeFromSeconds (& ctx, 1.0 / 240.0);

// Set period of the master clock
BKContextSetPtr (& ctx, BK_CLOCK_PERIOD, & time);

// Get period of the master clock
BKContextGetPtr (& ctx, BK_CLOCK_PERIOD, & time);
{% endhighlight %}

</dd>
<dt><var>BK_TIME</var> (<var>BKTime</var>)</dt>
<dd>

<p>This is the current absolute number of frames generated since initialization or the last reset of the context. This attribute is read-only.</p>

{% highlight c %}
BKTime time;

// Get absolute time
BKContextGetPtr (& ctx, BK_TIME, & time);
{% endhighlight %}

</dd>
</dl>

## Functions <span class="header-file">(<a href="https://github.com/detomon/BlipKit/blob/master/src/BKContext.h"><var>BKContext.h</var></a>)</span>

### BKContextInit

	BKInt BKContextInit (BKContext * ctx, BKInt numChannels, BKInt sampleRate)

Initialize a context object with <var>numChannel</var> channels and a samplet rate of <var>sampleRate</var>. On success <var>0</var> is returned.

Possible return errors:

<var>BK_ALLOCATION_ERROR</var> if memory could not be allocated.

### BKContextDispose

	void BKContextDispose (BKContext * ctx)

Dispose the context and free resources. Track which are still attached are detached now.
